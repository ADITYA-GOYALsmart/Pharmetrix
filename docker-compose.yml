services:
  primary-node:
    build:
      context: ./servers/primary-node
      dockerfile: dockerfile
    container_name: pharmetrix-primary-node
    environment:
      - NODE_ENV=production
      - PORT=4200
    ports:
      - "4200:4200"

  streaming-node:
    build:
      context: ./servers/streaming-node
    container_name: pharmetrix-streaming-node
    environment:
      - NODE_ENV=production
      - PORT=4000
    ports:
      - "4000:4000"
    depends_on:
      - primary-node

  edge-py:
    build:
      context: ./servers/edge-py
      dockerfile: dockerfile
    container_name: pharmetrix-edge-py
    environment:
      - PORT=8000
      - CORS_ALLOWED_ORIGINS=*
    ports:
      - "8000:8000"

  react-client:
    build:
      context: ./clients/react
      dockerfile: Dockerfile
    container_name: pharmetrix-react-client
    ports:
      - "5000:80"
    depends_on:
      - primary-node
      - streaming-node
      - edge-py

  angular-client:
    build:
      context: ./clients/angular
      dockerfile: Dockerfile
    container_name: pharmetrix-angular-client
    ports:
      - "5001:80"
    depends_on:
      - primary-node
      - streaming-node
      - edge-py

# Optional networks/volumes can be added as needed